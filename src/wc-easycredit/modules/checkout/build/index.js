(()=>{"use strict";var e={20:(e,t,n)=>{var r=n(609),a=Symbol.for("react.element"),o=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,c={},d=null,l=null;for(r in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!i.hasOwnProperty(r)&&(c[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===c[r]&&(c[r]=t[r]);return{$$typeof:a,type:e,key:d,ref:l,props:c,_owner:s.current}}t.jsx=c,t.jsxs=c},848:(e,t,n)=>{e.exports=n(20)},609:e=>{e.exports=window.React}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{const e=window.wc.wcBlocksRegistry,t=window.wp.element,r=window.wp.data,a=window.wc.wcBlocksData,o=window.wp.i18n,s=window.wp.htmlEntities,i=window.wc.wcSettings;var c=n(848);const d=e=>{const n=(0,i.getSetting)(e+"_data");let d=null;const l=({billing:o,eventRegistration:i,activePaymentMethod:l})=>{const{onCheckoutFail:u,onCheckoutValidation:y}=i,p=(0,r.useSelect)((e=>e(a.VALIDATION_STORE_KEY).hasValidationErrors())),m=(0,t.useRef)(null),w=(0,t.useRef)(!1),f=async()=>{let e;do{const t=".wc-block-components-checkout-place-order-button";if(e=document.querySelector(t),!e)return void console.error('Could not submit order. Submit button with selector "$(selector)" was not found');await new Promise((e=>setTimeout(e,100)))}while(e.disabled);e.dispatchEvent(new window.MouseEvent("click",{bubbles:!0}))};return(0,t.useEffect)((()=>{d&&document.removeEventListener("easycredit-submit",d);const e=((e,t,r)=>(d=a=>{a.target.matches("easycredit-checkout")&&a.target.getAttribute("payment-type")===n.paymentType&&(t?a.target.dispatchEvent(new Event("closeModal")):(e.current=!0,r()))},d))(w,p,f);console.log("adding listener for "+n.paymentType),document.addEventListener("easycredit-submit",e)}),[p]),(0,t.useEffect)((()=>l!==n.id||y((()=>!m.current||!(!w.current&&"easycredit_ratenkauf"===e)||(m.current.dispatchEvent(new Event("openModal")),{errorMessage:"Bitte stimmen Sie der DatenÃ¼bermittlung zu."})))),[y,l,w]),(0,t.useEffect)((()=>l!==n.id||u((()=>{m.current&&m.current.dispatchEvent(new Event("closeModal"))}))),[u,l]),(0,c.jsxs)("div",{children:[(0,c.jsx)("easycredit-checkout",{ref:m,"webshop-id":(0,s.decodeEntities)(n.apiKey),amount:o.cartTotal.value/100,"payment-type":n.paymentType}),(0,c.jsx)("span",{style:{display:"none"},children:"Checkout Component"})]})},u=()=>(0,c.jsx)("easycredit-checkout-label",{"payment-type":n.paymentType});let y={name:e,content:(0,c.jsx)(l,{}),edit:(0,c.jsx)(l,{}),canMakePayment:()=>n.enabled,paymentMethodId:n.id,label:(0,c.jsx)(u,{}),ariaLabel:"easycredit"};return"easycredit_rechnung"===e&&(y={...y,placeOrderButtonLabel:(0,o.__)("Continue to pay by invoice")}),"easycredit_ratenkauf"===e&&(y={...y,placeOrderButtonLabel:(0,o.__)("Continue to pay by installments")}),y},l=Object.fromEntries(Object.entries((0,i.getSetting)("paymentMethodData")).filter((([e,t])=>e.match(/^easycredit_/)))),[u,y]=Object.entries(l)[0];document.addEventListener("easycredit-submit",(e=>{if(!e.target.matches("easycredit-express-button"))return;const t=(e=>{let t={};e.express="1";for(let[n,r]of Object.entries(e))t["easycredit["+n+"]"]=r;return t})(e.detail),n=new URLSearchParams(t).toString();window.location.href=y.expressUrl+"?"+n}));const p=e=>{const n=(0,t.useRef)(null),r=e.billing.cartTotal.value/100;return(0,c.jsx)("easycredit-express-button",{ref:n,"webshop-id":(0,s.decodeEntities)(y.apiKey),amount:r,"payment-types":m("paymentType").join(",")})},m=e=>Object.entries(l).map((t=>t[1][e])),w={name:"easycredit",content:(0,c.jsx)(p,{}),edit:(0,c.jsx)(p,{}),canMakePayment:()=>m("enabled").some(Boolean)},f=d("easycredit_rechnung");(0,e.registerPaymentMethod)(f);const h=d("easycredit_ratenkauf");if((0,e.registerPaymentMethod)(h),f.name===w.name||h.name===w.name)throw new Error("express method and normal payment method may not have the same name");(0,e.registerExpressPaymentMethod)(w)})()})();