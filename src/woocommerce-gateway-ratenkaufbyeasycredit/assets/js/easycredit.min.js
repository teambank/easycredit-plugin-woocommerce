!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(o,e,t,i){function a(){return n.length?n[n.length-1]:null}function s(){for(var e=!1,t=n.length-1;0<=t;t--)n[t].$blocker&&(n[t].$blocker.toggleClass("easycreditmodal-current",!e).toggleClass("easycreditmodal-behind",e),e=!0)}var n=[];o.easycreditmodal=function(i,e){var s;if(this.$body=o("body"),this.options=o.extend({},o.easycreditmodal.defaults,e),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),this.$blocker=null,this.options.closeExisting)for(;o.easycreditmodal.isActive();)o.easycreditmodal.close();if(n.push(this),i.is("a"))if(e=i.attr("href"),this.anchor=i,/^#/.test(e)){if(this.$elm=o(e),1!==this.$elm.length)return null;this.$body.append(this.$elm),this.open()}else this.$elm=o("<div>"),this.$body.append(this.$elm),s=function(e,t){t.elm.remove()},this.showSpinner(),i.trigger(o.easycreditmodal.AJAX_SEND),o.get(e).done(function(e){var t;o.easycreditmodal.isActive()&&(i.trigger(o.easycreditmodal.AJAX_SUCCESS),(t=a()).$elm.empty().append(e).on(o.easycreditmodal.CLOSE,s),t.hideSpinner(),t.open(),i.trigger(o.easycreditmodal.AJAX_COMPLETE))}).fail(function(){i.trigger(o.easycreditmodal.AJAX_FAIL),a().hideSpinner(),n.pop(),i.trigger(o.easycreditmodal.AJAX_COMPLETE)});else this.$elm=i,this.anchor=i,this.$body.append(this.$elm),this.open()},o.easycreditmodal.prototype={constructor:o.easycreditmodal,open:function(){var e=this;this.block(),this.anchor.blur(),this.options.doFade?setTimeout(function(){e.show()},this.options.fadeDuration*this.options.fadeDelay):this.show(),o(t).off("keydown.easycreditmodal").on("keydown.easycreditmodal",function(e){var t=a();27===e.which&&t.options.escapeClose&&t.close()}),this.options.clickClose&&this.$blocker.click(function(e){e.target===this&&o.easycreditmodal.close()})},close:function(){n.pop(),this.unblock(),this.hide(),this.$elm.remove(),o.easycreditmodal.isActive()||o(t).off("keydown.easycreditmodal")},block:function(){this.$elm.trigger(o.easycreditmodal.BEFORE_BLOCK,[this._ctx()]),this.$body.css("overflow","hidden"),this.$blocker=o('<div class="'+this.options.blockerClass+' easycreditmodal-blocker easycreditmodal-current"></div>').appendTo(this.$body),s(),this.options.doFade&&this.$blocker.css("opacity",0).animate({opacity:1},this.options.fadeDuration),this.$elm.trigger(o.easycreditmodal.BLOCK,[this._ctx()])},unblock:function(e){!e&&this.options.doFade?this.$blocker.fadeOut(this.options.fadeDuration,this.unblock.bind(this,!0)):(this.$blocker.children().appendTo(this.$body),this.$blocker.remove(),this.$blocker=null,s(),o.easycreditmodal.isActive()||this.$body.css("overflow",""))},show:function(){this.$elm.trigger(o.easycreditmodal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=o('<a href="#close-easycreditmodal" rel="easycreditmodal:close" class="close-easycreditmodal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass).appendTo(this.$blocker),this.options.doFade?this.$elm.css({opacity:0,display:"inline-block"}).animate({opacity:1},this.options.fadeDuration):this.$elm.css("display","inline-block"),this.$elm.trigger(o.easycreditmodal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(o.easycreditmodal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove();var e=this;this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration,function(){e.$elm.trigger(o.easycreditmodal.AFTER_CLOSE,[e._ctx()])}):this.$elm.hide(0,function(){e.$elm.trigger(o.easycreditmodal.AFTER_CLOSE,[e._ctx()])}),this.$elm.trigger(o.easycreditmodal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||o('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},_ctx:function(){return{elm:this.$elm,$elm:this.$elm,$blocker:this.$blocker,options:this.options}}},o.easycreditmodal.close=function(e){if(o.easycreditmodal.isActive())return e&&e.preventDefault(),e=a(),e.close(),e.$elm},o.easycreditmodal.isActive=function(){return 0<n.length},o.easycreditmodal.getCurrent=a,o.easycreditmodal.defaults={closeExisting:!0,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",modalClass:"easycreditmodal",blockerClass:"jquery-easycreditmodal",spinnerHtml:'<div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div>',showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1},o.easycreditmodal.BEFORE_BLOCK="modal:before-block",o.easycreditmodal.BLOCK="modal:block",o.easycreditmodal.BEFORE_OPEN="modal:before-open",o.easycreditmodal.OPEN="modal:open",o.easycreditmodal.BEFORE_CLOSE="modal:before-close",o.easycreditmodal.CLOSE="modal:close",o.easycreditmodal.AFTER_CLOSE="modal:after-close",o.easycreditmodal.AJAX_SEND="modal:ajax:send",o.easycreditmodal.AJAX_SUCCESS="modal:ajax:success",o.easycreditmodal.AJAX_FAIL="modal:ajax:fail",o.easycreditmodal.AJAX_COMPLETE="modal:ajax:complete",o.fn.easycreditmodal=function(e){return 1===this.length&&new o.easycreditmodal(this,e),this},o(t).on("click.easycreditmodal",'a[rel~="easycreditmodal:close"]',o.easycreditmodal.close),o(t).on("click.easycreditmodal",'a[rel~="easycreditmodal:open"]',function(e){e.preventDefault(),o(this).easycreditmodal()})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(o){function a(e,i){return e.replace(/%(\w*)%/g,function(e,t){return i.hasOwnProperty(t)?i[t]:""})}function s(t){var t=o.extend({},n,t),i=o(this);if(o(this).data("easycredit-amount")&&(t.amount=o(this).data("easycredit-amount")),isNaN(t.amount)||t.amount<200||1e4<t.amount)t.debug&&console.log(t.amount+" is not within allowed range");else{if(null==t.webshopId||""==t.webshopId)throw new Error("webshopId must be set for easycredit widget");var e,s=[t.hostname+t.endpoint,o.param({webshopId:t.webshopId,finanzierungsbetrag:t.amount})].join("?");e=function(e){!e||0<e.wsMessages.messages.length||((e={number_of_installments:e.anzahlRaten,amount:(e=e.betragRate,Number(Math.round(e+"e2")+"e-2").toFixed(2).replace(".",",")),currency_symbol:t.currencySymbol,suffix:t.suffix,link_text:t.linkText}).installmentTemplate=a(t.installmentTemplate,e),e=o(a(t.widgetTemplate,e)),o(i).append(e),e.find("a").click(function(e,t){var i=d(l(t));t.modal(e,i)}.bind(this,i,t)))},o.ajax({type:"GET",url:s,contentType:"application/json; charset=utf-8",dataType:"jsonp",success:e})}}var e={template:['<div class="easycredit-modal">','<div class="easycredit-embed-responsive"></div>',"</div>"].join("\n"),handleModal:function(e,t){var i=o(this.template);i.find(".easycredit-embed-responsive").append(t).css({height:"670px","max-height":"670px"}),o(e).append(i),i.easycreditmodal()},init:function(e,t){this.handleModal(e,t)}},n={hostname:"https://ratenkauf.easycredit.de",endpoint:"/ratenkauf-ws/rest/v1/modellrechnung/guenstigsterRatenplan",iframeSrc:"/ratenkauf/content/intern/paymentPageBeispielrechnung.jsf",modal:e.init.bind(e),webshopId:null,amount:null,debug:!1,currencySymbol:"&euro;",installmentTemplate:"%amount% %currency_symbol% / Monat",widgetTemplate:['<div class="easycredit-widget">','<span class="easycredit-suffix">%suffix% </span>','<span class="easycredit-rate">%installmentTemplate%</span>',"<br />",'<a class="easycredit-link">%link_text%</a>',"</div>"].join("\n"),suffix:"Finanzieren ab",linkText:"mehr Infos zum Ratenkauf"},l=function(e){return[e.hostname+e.iframeSrc,o.param({shopKennung:e.webshopId,bestellwert:e.amount})].join("?")},d=function(e){return'<iframe class="embed-responsive-item" src="'+e+'"></iframe>'};o.fn.rkPaymentPage=function(i){return this.each(function(e,t){s.apply(t,[i])})},window.rkPlugin={},window.rkPlugin.anzeige=function(e,t){o("#"+e).rkPaymentPage(t)}}),jQuery(function(e){var t=e("meta[name=easycredit-widget-selector]").attr("content");e(t).rkPaymentPage({webshopId:e("meta[name=easycredit-api-key]").attr("content"),amount:e("meta[name=easycredit-widget-price]").attr("content")}),e(".woocommerce-checkout").on("change","#billing_company",function(){e(this).trigger("update_checkout")})});
//# sourceMappingURL=easycredit.min.js.map